<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>News View</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
<style>
  body { font-family: Poppins, sans-serif; margin:0; padding:16px; background:#f5f6fa; }
  .wrap { max-width:900px; margin:18px auto; background:#fff; padding:20px; border-radius:8px; box-shadow:0 6px 18px rgba(0,0,0,0.06); }
  h1 { margin:0 0 8px 0; }
  .meta { color:#666; font-size:0.9rem; margin-bottom:12px; }
  img, video { max-width:100%; border-radius:6px; display:block; margin:12px 0; }
  p { white-space:pre-wrap; line-height:1.6; }
  @media(max-width:600px) { .wrap { padding:14px; } }
</style>
</head>
<body>
  <div class="wrap" id="wrap">Loading...</div>
<script>
const params = new URLSearchParams(window.location.search);
const id = params.get('id');

const wrap = document.getElementById('wrap');

if (!id) {
  wrap.innerText = 'No news id provided';
  throw new Error('No ID');
}

fetch('/api/news/' + id)
  .then(res => res.json())
  .then(n => {
    if (!n || !n.id) {
      wrap.innerText = 'News not found';
      return;
    }

    const mediaHtml = n.image_url
      ? `<img src="${n.image_url}" alt="news image">`
      : '';

    wrap.innerHTML = `
      <h1>${escapeHtml(n.title)}</h1>
      <div class="meta">${new Date(n.created_at).toLocaleString()}</div>
      ${mediaHtml}
      <p>${escapeHtml(n.content)}</p>
    `;
  })
  .catch(err => {
    console.error(err);
    wrap.innerText = 'Error loading news';
  });

function escapeHtml(s) {
  if (!s) return '';
  return String(s)
    .replaceAll('&','&amp;')
    .replaceAll('<','&lt;')
    .replaceAll('>','&gt;')
    .replaceAll('"','&quot;');
}
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sri Ambal Nagar Peoples Welfare Association</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet" />
<style>
body, ul, h1, h2, p { margin: 0; padding: 0; }

body {
  font-family: 'Poppins', sans-serif;
  text-align: center;
  background-image: url('/uploads/image1.jpg');
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center center;
  min-height: 100vh;
}

/* DESKTOP HEADER (unchanged) */
header {
  padding: 10px 20px;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  background: transparent;
}
.header-container { display: flex; align-items: center; justify-content: space-between; }
.logo { font-size: 18px; font-weight: 700; }
nav { position: relative; }
ul.menu { list-style: none; display: flex; gap: 20px; justify-content: center; }
ul.menu li a { text-decoration: none; color: black; font-weight: 500; }
ul.menu li a.active, ul.menu li a:hover { color: #007BFF; }
.menu-toggle { display: none; }

/* CONTENT */
main { margin-top: 80px; }
.hero { height: calc(100vh - 80px); display: flex; flex-direction: column; justify-content: center; align-items: center; }
h2{ font-size: 35px; margin-bottom: 10px; color: whitesmoke; padding-top: 80px; }
p{ font-size: 20px; line-height: 1.5; color:whitesmoke; }
footer p{ text-align:center; padding:10px; font-size:16px; color:black; margin-top:40px; }

/* HERO ANIM */
.hero h2 {
  background: linear-gradient(white 100%);
  background-size: 200% 200%;
  color: transparent;
  -webkit-background-clip: text;
  background-clip: text;
  font-weight: 800;
  letter-spacing: 0.5px;
  text-shadow: 0 3px 12px rgba(0,0,0,0.15), 0 3px 8px #fff8;
  animation:
    heroFadeIn 1.2s cubic-bezier(.31,1.4,.51,1.1) forwards,
    gradientMove 4s alternate infinite;
}
.hero p {
  color: #f7fdff;
  font-weight: 700;
  letter-spacing: 0.12em;
  text-shadow: 0px 2px 10px rgba(0,0,0,0.19), 0 1px 1px #fff4;
  animation:
    heroFadeIn 1.1s cubic-bezier(.31,1.4,.51,1.1) .5s forwards;
}
@keyframes gradientMove {
  0% { background-position: 0% 50%; }
  100% { background-position: 100% 70%; }
}
@keyframes heroFadeIn {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.hero h2, .hero p {
  opacity: 0;
  transform: translateY(60px);
}

/* FLOATING SERVICE BUTTON */
.service-floating-btn{
  position: fixed;
  right: 20px;
  bottom: 28px;
  z-index: 3000;
}
.service-floating-btn a{
  min-width: 110px;
  height: 42px;
  padding: 0 22px;
  border-radius: 999px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  background: linear-gradient(135deg,black,black);
  color: white;
  font-weight: 700;
  font-size: 0.8rem;
  letter-spacing: .12em;
  text-transform: uppercase;
  box-shadow: 0 10px 26px rgba(248,113,113,0.75);
  position: relative;
  overflow: hidden;
  animation: btnFloat 2.4s ease-in-out infinite;
}
.service-floating-btn a::before{
  content:"";
  position:absolute;
  top:0;
  left:-40%;
  width:40%;
  height:100%;
  background: linear-gradient(120deg,rgba(255,255,255,0.75),transparent);
  transform:skewX(-25deg);
  opacity:0;
  animation: btnShine 3s linear infinite;
}
@keyframes btnFloat{
  0%,100%{transform:translateY(0);}
  50%{transform:translateY(-3px);}
}
@keyframes btnShine{
  0%{left:-40%;opacity:0;}
  20%{opacity:0.9;}
  50%{left:120%;opacity:0;}
  100%{left:120%;opacity:0;}
}
.service-floating-btn a:hover{
  box-shadow:0 16px 34px rgba(248,113,113,0.9);
  filter: brightness(1.05);
}

/* NEWS NOTIFY BAR */
#news-notify-bar {
  position: fixed;
  right:auto;
  left: 30px;
  bottom: 24px;
  z-index: 2500;
  background: transparent;
  width: 420px;
  max-width: 88vw;
  pointer-events: none;
}
#notify-card {
  background: rgba(255,255,255,0.28);
  border-radius: 14px;
  box-shadow:
    0 8px 24px rgba(50,62,120,0.13),
    0 2px 8px rgba(0,0,0,0.03),
    0 0 20px 6px rgba(255,230,50,0.26);
  min-height: 60px;
  padding: 12px 18px 12px 12px;
  display: flex;
  align-items: center;
  font-family: 'Poppins', sans-serif;
  pointer-events: auto;
  transition: transform 1.7s cubic-bezier(.49,1.2,.49,1.01), opacity .6s;
  transform: translateY(90px);
  opacity: 0;
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  border: 1.2px solid rgba(255,255,255,0.42);
  position: relative;
  overflow: hidden;
}
#notify-card.on { opacity: 1; transform: translateY(0); }
#notify-card.off { opacity: 0; transform: translateY(-90px); }
#notify-card::before {
  content: '';
  position: absolute;
  left: 0; right: 0; top: 0;
  height: 20px;
  border-radius: 14px 14px 0 0;
  pointer-events: none;
  background: linear-gradient(180deg, rgba(255,230,60,0.22) 0%, rgba(255,230,60,0.05) 100%);
  z-index: 1;
}
#notify-card img, #notify-card video {
  height: 42px;
  width: 58px;
  border-radius: 7px;
  margin-right: 14px;
  object-fit: cover;
  background: #e6edfa;
  flex-shrink: 0;
  z-index: 2;
}
#notify-card .card-main { flex:1; text-align: left; z-index: 2; }
#notify-card .card-title {
  font-weight: 700;
  color: #003d99;
  font-size: 1.05rem;
  margin: 0 0 3px 0;
}
#notify-card .card-desc {
  color: #222;
  font-size: 0.97rem;
  margin: 0 0 6px 0;
  white-space: pre-line;
}
#notify-card .card-meta {
  color: #666;
  font-size: 0.88rem;
}

/* MOBILE-ONLY CHANGES */
@media (max-width: 768px) {
  header {
    background: rgba(0,0,0,0.35);
    backdrop-filter: blur(6px);
  }
  .header-container {
    flex-direction: column;
    align-items: center;
    padding-bottom: 6px;
  }

  nav {
    width: 100%;
    overflow-x: auto;
    white-space: nowrap;
    margin-top: 8px;
    scrollbar-width: none;
  }
  nav::-webkit-scrollbar { display: none; }

  ul.menu {
    flex-direction: row;
    display: inline-flex;
    gap: 18px;
    width: max-content;
    padding: 8px 12px;
    background: rgba(255,255,255,0.9);
    border-radius: 999px;
  }
  ul.menu li { display: inline-block; }

  main { margin-top: 90px; }
  .hero { height: calc(100vh - 90px); }

  #news-notify-bar {
    right:0; left:auto; bottom:10px; width:98vw; max-width:none;
  }
  #notify-card { padding: 9px 6px 10px 8px;}

  .service-floating-btn{
    right: 16px;
    bottom: 78px;
  }
}

/* user pill on home */
.user-pill{
  position:absolute;
  top:65px;
  right:22px;
  display:flex;
  align-items:center;
  gap:8px;
  padding:6px 12px;
  border-radius:999px;
  background:transparent;
  color:#111111;
  font-size:0.9rem;
}
.user-avatar{
  width:26px;
  height:26px;
  border-radius:50%;
  object-fit:cover;
}
</style>
</head>
<body>

<header>
  <div class="header-container">
    <div style="display:flex; align-items:center;">
      <div style="
        background:#fff;
        padding:10px;
        border-radius:50%;
        box-shadow:0 4px 16px rgba(34,2,2,0.6);
        height:60px;
        width:60px;
        display:flex;
        align-items:center;
        justify-content:center;
      ">
        <!-- LOGO -->
        <img
          src="img/logo.png"
          alt="Ambal Nagar Logo"
          style="height:50px; width:50px; object-fit:cover; border-radius:50%;"
        />
      </div>

      <h1 class="logo" style="margin-left:10px;">
        AmbalNagar Makkal Nalvazhu Sangam
      </h1>
    </div>

    <!-- NAV -->
    <nav>
      <ul class="menu">
        <li><a href="/" class="active">Home</a></li>
        <li><a href="/about">About Us</a></li>
        <li><a href="/members">Members</a></li>
        <li><a href="/events">Events</a></li>
        <li><a href="/contact">Contact Us</a></li>
        <li><a href="/login">Login</a></li>

      </ul>
    </nav>
  </div>

  <!-- USER PILL -->
  <div class="user-pill" id="userPill" style="display:none;">
    <img src="img/avatar1.png" class="user-avatar" alt="User Avatar">
    <span id="loggedUserName"></span>
  </div>
</header>

<main>
  <section class="hero">
    <h2>Welcome to Sri Ambal Nagar Peoples Welfare Association</h2>
    <p>
      Building a united and thriving community through commitment,
      culture, and care.
    </p>
  </section>
</main>

<!-- NEWS BAR -->
<div id="news-notify-bar">
  <div id="notify-card"></div>
</div>

<!-- SERVICE BUTTON -->
<div class="service-floating-btn">
  <a href="service.html">
    <span>Service</span>
  </a>
</div>

<footer>
  <p>&copy; 2025 All rights reserved.</p>
</footer>

</body>



<script>
async function startNewsNotifyBar() {
  try {
    const res = await fetch('/api/getNews');
    const data = await res.json();
    if (!data || data.length === 0) {
      document.getElementById('notify-card').innerHTML = '<div>No news now</div>';
      return;
    }
    data.sort((a,b)=>b.id-a.id);
    let idx = 0;
    const bar = document.getElementById('notify-card');
    function render() {
      const n = data[idx];
      let media = "";
      if(n.media) {
        media = n.mediaType==="video"
          ? `<video src="${n.media}" muted playsinline preload="metadata"></video>`
          : `<img src="${n.media}" alt="thumb" />`;
      }
      bar.classList.remove("off");
      bar.classList.add("on");

      bar.innerHTML = `
        ${media}
        <div class="card-main">
          <div class="card-title">${escapeHtml(n.title)}</div>
          <div class="card-desc">${escapeHtml(n.content.substring(0,60))}...</div>
          <div class="card-meta">${new Date(n.date).toLocaleTimeString()} Â· <a href="newsview.html?id=${n.id}" style="color:#003d99;text-decoration:none" target="_blank">Read</a></div>
        </div>`;
      
      setTimeout(()=>{
        bar.classList.remove("on");
        bar.classList.add("off");
        setTimeout(()=>{
          idx = (idx+1)%data.length;
          render();
        }, 1900);
      }, 4000);
    }
    render();
  } catch(err) {
    document.getElementById('notify-card').innerHTML = 'Unable to load news';
  }
}
function escapeHtml(str) {
  if (!str) return '';
  return String(str)
    .replaceAll('&','&amp;')
    .replaceAll('<','&lt;')
    .replaceAll('>','&gt;')
    .replaceAll('"','&quot;')
    .replaceAll("'",'&#039;');
}
startNewsNotifyBar();

// ðŸ” Home user pill: logout à®†à®© à®ªà®¿à®±à®•à¯ show à®†à®•à®•à¯à®•à¯‚à®Ÿà®¾à®¤à¯
const stored = localStorage.getItem('currentUser');
if (!stored) {
  // guest or logout à®†à®© user â€“ pill hide
  const userPill = document.getElementById('userPill');
  if (userPill) userPill.style.display = 'none';
} else {
  const user = JSON.parse(stored);   // { username, name, avatar } [web:707]
  const userPill = document.getElementById('userPill');
  const nameSpan = document.getElementById('loggedUserName');
  const avatarImg = document.querySelector('#userPill .user-avatar');

  if (userPill && nameSpan && avatarImg) {
    nameSpan.textContent = user.name || user.username;
    const src = user.avatar && user.avatar.trim() !== ''
      ? user.avatar
      : 'img/avatar1.png';
    avatarImg.src = src;
    avatarImg.onerror = () => { avatarImg.src = 'img/avatar1.png'; };
    userPill.style.display = 'flex';  // show only if logged in
  }
}
</script>
</body>
</html>
